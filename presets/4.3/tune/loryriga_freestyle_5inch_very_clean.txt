#$ TITLE: Freestyle 5inch VERY CLEAN
#$ FIRMWARE_VERSION: 4.3
#$ CATEGORY: TUNE
#$ STATUS: EXPERIMENTAL
#$ KEYWORDS: filters, clean, freestyle, tune, pid, rpm
#$ AUTHOR: LoryRiga
#$ DESCRIPTION: Tune with filters for VERY CLEAN 5" freestyle bulds. 
#$ DESCRIPTION: Credits to Chris Rosser for the filter startegy used in this tune.
#$ DESCRIPTION: 
#$ DESCRIPTION: PIDs are based on freestyle quads with high power/weight ratio, hence they're a bit conservative for average builds. 
#$ DESCRIPTION: Raise the master slider to improve the performance if needed. 
#$ DESCRIPTION: Lower the master slider if you hear motors thrill, then raise the feedforward to the previous values with the dedicated slider.
#$ DESCRIPTION:
#$ DESCRIPTION: WARNING: RPM filter is required. Ensure that DShot Telemetry is working properly!
#$ DESCRIPTION:
#$ DESCRIPTION: WARNING: This setup have very little filtering and it's intended to be used only on well built quads with a sturdy frame and smooth motors.
#$ DESCRIPTION: Ensure that your props are in mint condition.
#$ DESCRIPTION: If motors get hot or make grind noise then choose a less aggressive filter startegy.


#APPLYING DEAFULT FILTERS AND TUNE
#$ INCLUDE: presets/4.3/tune/defaults.txt
#$ INCLUDE: presets/4.3/filters/defaults.txt
#DEAFULTS END. APPLYING CUSTOM FILTERS AND TUNE

# -- No gyro lowpass filters --
set gyro_lpf1_dyn_min_hz = 0
set gyro_lpf1_dyn_max_hz = 0
set gyro_lpf1_static_hz = 0
set gyro_lpf2_static_hz = 0

# -- Gyro Sliders OFF --
set simplified_gyro_filter_multiplier = OFF

# -- Gyro Static Notches (default)--

# -- Gyro Dynamic Notches --
set dyn_notch_count = 1
set dyn_notch_q = 500
set dyn_notch_min_hz = 150
set dyn_notch_max_hz = 600

# -- RPM filtering --
set dshot_bidir = ON
set rpm_filter_fade_range_hz = 100

# -- Dterm filtering --
set dterm_lpf1_dyn_min_hz = 80
set dterm_lpf1_dyn_max_hz = 110
set dterm_lpf1_dyn_expo = 8
set dterm_lpf1_static_hz = 0
set dterm_lpf2_static_hz = 0
set dterm_lpf1_type = BIQUAD

# -- Dterm sliders OFF --
set simplified_dterm_filter_multiplier = OFF

# -- Yaw lowpass (default) --

# -- PID Sliders (RP)--
set simplified_pids_mode = RP
set simplified_master_multiplier = 140
set simplified_i_gain = 75
set simplified_d_gain = 100
set simplified_pi_gain = 100
set simplified_dmax_gain = 0
set simplified_feedforward_gain = 105
set simplified_pitch_d_gain = 105
set simplified_pitch_pi_gain = 105
simplified_tuning apply

# -- Yaw PID values --
set p_yaw = 66
set i_yaw = 88
set d_yaw = 0
set d_min_yaw = 0
set f_yaw = 135

# -- iTerm relax --
set iterm_relax_cutoff = 10

# -- Feedforward  --
set feedforward_boost = 40

# -- TPA (default) --

# -- PIDsum limits--
set pidsum_limit = 1000
set pidsum_limit_yaw = 1000

# -- Dshot idle --
set dshot_idle_value = 700

#OPTIONS

#$ OPTION BEGIN (UNCHECKED): Dynamic Idle 
set dyn_idle_min_rpm = 35
set dyn_idle_p_gain = 35
#$ OPTION END

#$ OPTION BEGIN (UNCHECKED): 48/96kHz PWM (thrust_linear = 25)
# -- Thrust linear --
set thrust_linear = 25
#$ OPTION END

#$ OPTION BEGIN (UNCHECKED): Feedforward for 200-250Hz RC Links
# -- Feedforward  --
set feedforward_averaging = 2_POINT
set feedforward_smooth_factor = 30
#$ OPTION END

#$ OPTION BEGIN (UNCHECKED): F4 FC Speed Settings (WARNING: Enables DSHOT300)
# F4 FC Speed Settings
# -- Motor protocol -- 
set motor_pwm_protocol = DSHOT300
# -- Pidloop speed --
set pid_process_denom = 2
#$ OPTION END

#$ OPTION BEGIN (UNCHECKED): F7 FC Speed Settings (WARNING: Enables DSHOT600)
# F7 FC Speed Settings
# -- Motor protocol -- 
set motor_pwm_protocol = DSHOT600
# -- Pidloop speed --
set pid_process_denom = 1
#$ OPTION END

#$ OPTION BEGIN (CHECKED): With HD Camera

# -- PID Sliders (RP)--
set simplified_pids_mode = RP
set simplified_master_multiplier = 150
set simplified_i_gain = 80
set simplified_d_gain = 100
set simplified_pi_gain = 100
set simplified_dmax_gain = 0
set simplified_feedforward_gain = 105
set simplified_pitch_d_gain = 105
set simplified_pitch_pi_gain = 105
simplified_tuning apply

# -- Yaw PID values --
set p_yaw = 72
set i_yaw = 90
set d_yaw = 0
set d_min_yaw = 0
set f_yaw = 150

#$OPTION END
